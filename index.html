<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Geomap by x6doooo</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/x6doooo/GeoMap">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/x6doooo/GeoMap/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/x6doooo/GeoMap/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Geomap</h1>
          <p>JavaScript geoJSON map</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/x6doooo">x6doooo</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>GeoMap.js</h1>

<h2>概述</h2>

<ul>
<li><p>GeoMap.js是一个绘制矢量地图控件，基于jQuery、Raphael，</p></li>
<li><p>支持geoJSON格式的数据源</p></li>
<li><p>通过Raphael绘制地图，默认采用svg，低版本IE采用vml，兼容性较好</p></li>
</ul><h2>文件结构</h2>

<pre><code>json/               //地图数据
old/                //旧版（实现方法有问题，存做标本）
src/                //开发文件
geomap-0.X.X.js     //发布文件
example.html        //示例文件
</code></pre>

<h2>使用方法</h2>

<p>基本操作：</p>

<div class="highlight"><pre><span class="c1">//实例化一个GeoMap对象</span>
<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeoMap</span><span class="p">();</span>

<span class="c1">//载入json数据</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s1">'…'</span>
    <span class="nx">dataType</span><span class="o">:</span> <span class="s1">'json'</span>
<span class="p">}).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">){</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>     <span class="c1">//将数据载入GeoMap的实例对象</span>
<span class="p">});</span>

<span class="c1">//渲染</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
</pre></div>

<p>设置：</p>

<div class="highlight"><pre><span class="c1">//实例化GeoMap对象时可以传入设置项目的对象</span>
<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeoMap</span><span class="p">({</span><span class="err">…</span><span class="p">});</span>
<span class="cm">/*</span>
<span class="cm">    默认设置</span>
<span class="cm">    defaultCfg = {</span>
<span class="cm">        container: 'body',</span>
<span class="cm">        offset: null,</span>
<span class="cm">        scale: null,</span>
<span class="cm">        mapStyle: {</span>
<span class="cm">            'fill': '#fff',</span>
<span class="cm">            'stroke': '#999',</span>
<span class="cm">            'stroke-width': 0.7</span>
<span class="cm">        },</span>
<span class="cm">        crossline:{</span>
<span class="cm">            enable: true,</span>
<span class="cm">            color: '#ccc'</span>
<span class="cm">        },</span>
<span class="cm">        background:'#fff'</span>
<span class="cm">    };</span>
<span class="cm">*/</span>
</pre></div>

<p>指定渲染位置：</p>

<div class="highlight"><pre><span class="c1">//GeoMap默认在body元素下生成地图</span>
<span class="c1">//实例化时可以设置container指定渲染位置</span>
<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeoMap</span><span class="p">({</span>
    <span class="nx">container</span><span class="o">:</span> <span class="s1">'#map'</span>
<span class="p">});</span>
</pre></div>

<p>缩放与偏移：</p>

<div class="highlight"><pre><span class="c1">//geoJSON数据是真实地理经纬度数据</span>
<span class="c1">//转换到页面显示需要设置偏移和缩放</span>
<span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeoMap</span><span class="p">({</span>
    <span class="c1">//偏移：确定地图位置</span>
    <span class="nx">offset</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span>  <span class="c1">//世界地图默认不需位移</span>
    <span class="p">},</span>
    <span class="c1">//缩放：确定地图大小</span>
    <span class="nx">scale</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">x</span><span class="o">:</span> <span class="mf">2.6</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">3</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="c1">//如果不设置偏移，脚本会自动计算路径数据，并让地图从左上角开始渲染</span>
</pre></div>

<p>属性绑定：</p>

<div class="highlight"><pre><span class="c1">//通过Raphael的data方法绑定地区的属性</span>
</pre></div>

<p>操作地图上的区块：</p>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GeoMap</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>

<span class="c1">//渲染之后，map的shapes属性即地图上的各个区块，可以添加事件</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">shapes</span><span class="p">.</span><span class="nx">hover</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="p">...</span>
<span class="p">});</span>
</pre></div>

<p>画点：</p>

<div class="highlight"><pre><span class="c1">//map对象有一个setPoint方法，该方法接受一个坐标参数（取实际经纬度坐标）</span>
<span class="c1">//比如北京坐标是x: 116.4551, y: 40.2539</span>
<span class="nx">point</span> <span class="o">=</span> <span class="nx">map</span><span class="p">.</span><span class="nx">setPoint</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span> <span class="mf">116.4551</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mf">40.2539</span><span class="p">});</span>

<span class="c1">//点是用Raphael的circle方法画出的，可以通过属性设置，更改点的大小</span>
<span class="nx">point</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>

<p>计算一个点的实际经纬度：</p>

<div class="highlight"><pre><span class="nx">map</span><span class="p">.</span><span class="nx">getGeoPosition</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span> <span class="c1">//=&gt; 页面地图上10,10这个点的实际经纬度坐标</span>
</pre></div>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>